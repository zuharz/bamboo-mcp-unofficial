#!/bin/sh
# Pre-commit hook for BambooHR MCP Server
# Runs ESLint and TypeScript checks before allowing commits

echo "🔍 Running pre-commit checks..."

# Check if npm is available
if ! command -v npm &> /dev/null; then
    echo "❌ npm is not installed or not in PATH"
    exit 1
fi

# Run ESLint
echo "📋 Running ESLint..."
npm run lint
if [ $? -ne 0 ]; then
    echo "❌ ESLint failed. Please fix the linting errors before committing."
    echo "💡 Tip: Run 'npm run lint:fix' to auto-fix some issues"
    exit 1
fi

# Run TypeScript check
echo "🔧 Running TypeScript check..."
npm run typecheck
if [ $? -ne 0 ]; then
    echo "❌ TypeScript check failed. Please fix the type errors before committing."
    exit 1
fi

echo "✅ Pre-commit checks passed!"
exit 0