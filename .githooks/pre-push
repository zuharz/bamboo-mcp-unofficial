#!/bin/sh
# Pre-push hook for BambooHR MCP Server
# Runs tests before allowing pushes

echo "ğŸ§ª Running pre-push checks..."

# Check if npm is available
if ! command -v npm &> /dev/null; then
    echo "âŒ npm is not installed or not in PATH"
    exit 1
fi

# Run tests
echo "ğŸ”¬ Running test suite..."
npm test
if [ $? -ne 0 ]; then
    echo "âŒ Tests failed. Please fix the failing tests before pushing."
    echo "ğŸ’¡ Tip: Run 'npm test' locally to debug the issues"
    exit 1
fi

# Run build to ensure everything compiles
echo "ğŸ—ï¸ Running build check..."
npm run build
if [ $? -ne 0 ]; then
    echo "âŒ Build failed. Please fix the build errors before pushing."
    exit 1
fi

echo "âœ… Pre-push checks passed!"
exit 0